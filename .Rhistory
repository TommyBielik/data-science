labs(title = "Ako reklama ovplyvňuje predaje autosedačiek",
x = "Reklama", y = "Predaje")
View(Carseats)
ggplot(seats, aes(x = Advertising, fill = factor(Sales))) +
geom_bar(color = "purple", position = "dodge") +
labs(title = "Ako reklama ovplyvňuje predaje autosedačiek")
ggplot(seats, aes(x = Advertising, y = Sales)) +
geom_line(color = "purple") +
labs(title = "Ako reklama ovplyvňuje predaje autosedačiek",
x = "Reklama", y = "Predaje")
ggplot(seats, aes(x = Advertising, y = Sales)) +
geom_point(color = "purple") +
labs(title = "Ako reklama ovplyvňuje predaje autosedačiek",
x = "Reklama", y = "Predaje")
ggplot(seats, aes(x = Price, y = Sales)) +
geom_point(color = "purple") +
labs(title = "Ako cena sedačiek ovplyvňuje ich predaje",
x = "Cena", y = "Predaje")
ggplot(seats, aes(x = Price, y = Sales)) +
geom_line(color = "purple") +
labs(title = "Ako cena sedačiek ovplyvňuje ich predaje",
x = "Cena", y = "Predaje")
boxplot(Sales ~ ShelveLoc, data = seats)
num <- seats %>% select_if(is.numeric)
cor(num)
num <- seats %>% select_if(is.numeric)
cor(num)
seats$ShelveLoc <- factor(seats$ShelveLoc)
seats$Urban <- factor(seats$Urban)
seats$US <- factor(seats$US)
lm_model <- lm(Sales ~ Price + Advertising + Income + Age + ShelveLoc,
data = seats)
summary(lm_model)
knitr::opts_chunk$set(echo = TRUE)
vif <- vif(lm_model)
library(car)
vif <- vif(lm_model)
print(vif)
set.seed(123)
split <- initial_split(seats, prop = 0.7)
library(ISLR)
library(tidyverse)
library(rsample)
library(car)
#import datasetu Carseats z knižnice ISLR
data(Carseats)
View(Carseats)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
library(ISLR)
library(tidyverse)
library(rsample)
library(car)
#import datasetu Carseats z knižnice ISLR
data(Carseats)
View(Carseats)
#Načítanie datasetu do premennej na následné spracovanie, úpravu a analýzu
seats <- Carseats
summary(seats)
colSums(is.na(seats))
hist(seats$Sales)
ggplot(seats, aes(x = Price, y = Sales)) +
geom_line(color = "purple") +
labs(title = "Ako cena sedačiek ovplyvňuje ich predaje",
x = "Cena", y = "Predaje")
ggplot(seats, aes(x = Advertising, y = Sales)) +
geom_point(color = "purple") +
labs(title = "Ako reklama ovplyvňuje predaje autosedačiek",
x = "Reklama", y = "Predaje")
boxplot(Sales ~ ShelveLoc, data = seats)
num <- seats %>% select_if(is.numeric)
cor(num)
#Faktorizácia premenných
seats$ShelveLoc <- factor(seats$ShelveLoc)
seats$Urban <- factor(seats$Urban)
seats$US <- factor(seats$US)
lm_model <- lm(Sales ~ Price + Advertising + Income + Age + ShelveLoc,
data = seats)
summary(lm_model)
#Výsledok vif testu si uložíme do premennej, ktorú následne zobrazíme pomocou príkazu print()
vif <- vif(lm_model)
print(vif)
set.seed(123)
split <- initial_split(seats, prop = 0.7)
train <- training(split)
test <- testing(split)
#Nastavíme seed, aby sme zaistili náhodnosť pri výbere dát do trénovacej a testovacej množiny
set.seed(123)
#Následne rozdelíme dáta do trénovacej a testovacej množiny
split <- initial_split(seats, prop = 0.7)
train <- training(split)
test <- testing(split)
#Vytvoríme model z trénovacej množiny dát
train_model <- lm(Sales ~ Price + Advertising + Income + ShelveLoc, data = train)
#Nastavíme seed, aby sme zaistili náhodnosť pri výbere dát do trénovacej a testovacej množiny
set.seed(123)
#Následne rozdelíme dáta do trénovacej a testovacej množiny
split <- initial_split(seats, prop = 0.7)
train <- training(split)
test <- testing(split)
#Vytvoríme model z trénovacej množiny dát
train_model <- lm(Sales ~ Price + Advertising + Income + ShelveLoc, data = train)
summary(train_model)
pred <- predict(lm_model, newdata = test)
pred <- predict(lm_model, newdata = test)
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
pred <- predict(lm_model, newdata = test)
summary(pred)
pred <- predict(lm_model, newdata = test)
head(pred)
pred <- predict(lm_model, newdata = test)
View(pred)
pred <- predict(lm_model, newdata = test)
result <- ifelse(pred > 0.5, 1, 0)
pred <- predict(lm_model, newdata = test)
result <- ifelse(pred > 0.5, 1, 0)
head(result)
pred <- predict(lm_model, newdata = test)
result <- ifelse(pred > 0.5, 1, 0)
fitted_err <- mean(result != test$Sales)
fitted_acc <- 1 - fitted_err
#zostrojenie confusion matrix
table(result , test$Sales)
fit_result <- ifelse(fit_probab > 0.5,1,0)
source("C:/Users/tomin/OneDrive/Počítač/Data science v R/ako projekt.R")
# ---- EDA + logit----
library(titanic)
library(tidyverse)
str(titanic_train)
data("titanic_train")
titanic_clean <- titanic_train %>%
select(- PassengerId, -Name , -Ticket, -Cabin)
# chybajuce hodnoty
summary(titanic_clean)
colSums(is.na(titanic_clean))
#vek podla triedy
age_class <- titanic_clean %>%
group_by(Pclass)%>%
summarise(median(Age , na.rm = TRUE))
age_class
#nahradenie chybajucich hodnot vo veku
titanic_clean <- titanic_clean%>%
mutate(Age = ifelse(is.na(Age)& Pclass == 1 , 37,
ifelse(is.na(Age) & Pclass == 2 , 29,
ifelse(is.na(Age) & Pclass == 3 , 24, Age))))
summary(titanic_clean)
view(titanic_clean)
#prezivsi vs pohlavie
ggplot(titanic_clean, aes(x = Sex, fill = factor(Survived))) +
geom_bar(position = "dodge") +
labs(title = "Survived vs Gender")
#prezivsi vs vek
ggplot(titanic_clean, aes(x = Age, fill = factor(Survived))) +
geom_histogram(position = "dodge") +
labs(title = "Survived vs Age")
# prezivsi vs trieda
ggplot(titanic_clean, aes(x = Pclass, fill = factor(Survived))) +
geom_bar(position = "dodge") +
labs(title = "Survived vs Class")
# podiely prezivsich  medzi triedami
table(titanic_clean$Pclass , titanic_clean$Survived)
prop.table(table(titanic_clean$Pclass , titanic_clean$Survived) , margin = 1
)
#uprava premennych na faktory
str(titanic_clean)
titanic_clean$Survived <- factor(titanic_clean$Survived)
titanic_clean$Pclass <- factor(titanic_clean$Pclass)
titanic_clean$Sex <- factor(titanic_clean$Sex)
titanic_clean$SibSp <- factor(titanic_clean$SibSp)
titanic_clean$Parch <- factor(titanic_clean$Parch)
titanic_clean$Embarked <- factor(titanic_clean$Embarked)
# logit model
log_model <- glm(formula = Survived ~ ., family = binomial("logit") ,
data = titanic_clean)
summary(log_model)
library(rsample)
set.seed(101)
data_split <- initial_split(titanic_clean, prop = 0.7)
data_split
train_data <- training(data_split)
test_data <- testing(data_split)
#odhad treningoveho modelu
log_model <- glm(formula = Survived ~ Pclass + Sex + Age + SibSp + Fare, family = binomial("logit") ,
data = train_data)
summary(log_model)
#odhad na testovacom modeli
fin_log_model <- glm(formula = Survived ~ Pclass + Sex + Age + SibSp + Fare, family = binomial("logit") ,
data = test_data)
summary(fin_log_model)
#ulozenie prognozovanych hodnot
fit_probab <- predict(fin_log_model , newdata = test_data)
fit_result <- ifelse(fit_probab > 0.5,1,0)
# percentualny podiel spravnych odpovedi
fitted_err <- mean(fit_result != test_data$Survived)
fitted_acc <- 1 - fitted_err
#zostrojenie confusion matrix
table(fit_result , test_data$Survived)
pred <- predict(lm_model, newdata = test)
summary(pred)
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
pred <- predict(lm_model, newdata = test)
table(pred)
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
pred <- predict(lm_model, newdata = test)
View(pred)
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
pred <- predict(lm_model, newdata = test)
head(pred)
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
pred <- predict(lm_model, newdata = test)
real_predict <- test
real_predict$predicted <- pred
real_predict$difference <- real_predict$actual - real_predict$predicted
pred <- predict(lm_model, newdata = test)
real_predict <- test
real_predict$predicted <- pred
real_predict$difference <- real_predict$Sales - real_predict$predicted
head(real_predict, 10)
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
pred <- predict(lm_model, newdata = test)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
head(final_predict_table[final_predict_table$index %in% c(1, 6) ])
final_predict_table[final_predict_table$index %in% c(1, 6) ]
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
final_predict_table[final_predict_table$index %in% c(1, 6), ]
final_predict_table[final_predict_table$index %in% c(1, 6) ]
final_predict_table[final_predict_table$index %in% c(1, 6) ]
final_predict_table[final_predict_table$index %in% c(1, 6) ]
final_predict_table[final_predict_table$index %in% c("1", "6") ]
final_predict_table[final_predict_table$index %in% c("1", "6"), ]
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
difference_table$index <- rownames(difference_table)
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(index, Sales, predicted, difference)
head(final_predict_table)
final_predict_table[final_predict_table$index %in% c("1", "6"), ]
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(index, Sales, predicted, difference)
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
final_predict_table[1, 6]
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
final_predict_table[1, 6]
difference_table[1, 6]
difference_table[1, 6,]
View(difference_table)
difference_table[c(1, 6)]
difference_table[c(1, 6),]
difference_table[c(1, 5),]
difference_table[c(1, 3),]
difference_table[difference_table$index %in% c(1, 3), ]
difference_table[difference_table$index %in% c(1, 3), ]
difference_table[difference_table$index %in% c(1, 3)]
difference_table[difference_table$index %in% c(1, 3),]
# pridáme pôvodný index ako stĺpec
difference_table$index <- as.numeric(rownames(difference_table))
# teraz môžeme vybrať podľa hodnôt indexu
difference_table[difference_table$index %in% c(1,3), ]
# pridáme pôvodný index ako stĺpec
difference_table$index <- as.numeric(rownames(difference_table))
# teraz môžeme vybrať podľa hodnôt indexu
difference_table[difference_table$index %in% c(1,6), ]
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
difference_table$index <- as.numeric(rownames(difference_table))
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
difference_table[difference_table$index %in% c(1,6), ]
difference_table[difference_table$index %in% c(1,6), !names(difference_table) %in% c("Population", "Education", "CompPrice")]
difference_table[difference_table$index %in% c(1,6), !names(difference_table) %in% c("Population", "Education", "CompPrice", "Urban", "US")]
#Vyberieme riadky s indexami 1 a 6 a odstránime štatisticky nevýznamné stĺpce
difference_table[difference_table$index %in% c(1,6), !names(difference_table) %in% c("Population", "Education", "CompPrice", "Urban", "US")]
#Vyberieme riadky s indexami 1 a 6 a odstránime štatisticky nevýznamné stĺpce
difference_table[difference_table$index %in% c(1,6, 12), !names(difference_table) %in% c("Population", "Education", "CompPrice", "Urban", "US")]
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
library(ISLR)
library(tidyverse)
library(rsample)
library(car)
#import datasetu Carseats z knižnice ISLR
data(Carseats)
View(Carseats)
#Načítanie datasetu do premennej na následné spracovanie, úpravu a analýzu
seats <- Carseats
summary(seats)
colSums(is.na(seats))
hist(seats$Sales)
ggplot(seats, aes(x = Price, y = Sales)) +
geom_line(color = "purple") +
labs(title = "Ako cena sedačiek ovplyvňuje ich predaje",
x = "Cena", y = "Predaje")
ggplot(seats, aes(x = Advertising, y = Sales)) +
geom_point(color = "purple") +
labs(title = "Ako reklama ovplyvňuje predaje autosedačiek",
x = "Reklama", y = "Predaje")
boxplot(Sales ~ ShelveLoc, data = seats)
num <- seats %>% select_if(is.numeric)
cor(num)
#Faktorizácia premenných
seats$ShelveLoc <- factor(seats$ShelveLoc)
seats$Urban <- factor(seats$Urban)
seats$US <- factor(seats$US)
lm_model <- lm(Sales ~ Price + Advertising + Income + Age + ShelveLoc,
data = seats)
summary(lm_model)
#Výsledok vif testu si uložíme do premennej, ktorú následne zobrazíme pomocou príkazu print()
vif <- vif(lm_model)
print(vif)
#Nastavíme seed, aby sme zaistili náhodnosť pri výbere dát do trénovacej a testovacej množiny
set.seed(123)
#Následne rozdelíme dáta do trénovacej a testovacej množiny
split <- initial_split(seats, prop = 0.7)
train <- training(split)
test <- testing(split)
#Vytvoríme model z trénovacej množiny dát
train_model <- lm(Sales ~ Price + Advertising + Income + ShelveLoc, data = train)
summary(train_model)
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
difference_table$index <- as.numeric(rownames(difference_table))
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
#Vyberieme riadky s indexami 1, 6 a 12 a odstránime štatisticky nevýznamné stĺpce
difference_table[difference_table$index %in% c(1,6, 12), !names(difference_table) %in% c("Population", "Education", "CompPrice", "Urban", "US")]
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
MSE <- mean((test$Sales - pred)^2)
MSE
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
#Nastavíme seed, aby sme zaistili náhodnosť pri výbere dát do trénovacej a testovacej množiny
set.seed(123)
#Následne rozdelíme dáta do trénovacej a testovacej množiny
split <- initial_split(seats, prop = 0.7)
train <- training(split)
test <- testing(split)
#Vytvoríme model z trénovacej množiny dát
train_model <- lm(Sales ~ Price + Advertising + Income + ShelveLoc + Age, data = train)
summary(train_model)
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
difference_table$index <- as.numeric(rownames(difference_table))
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
#Vyberieme riadky s indexami 1, 6 a 12 a odstránime štatisticky nevýznamné stĺpce
difference_table[difference_table$index %in% c(1,6, 12), !names(difference_table) %in% c("Population", "Education", "CompPrice", "Urban", "US")]
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
library(ISLR)
library(tidyverse)
library(rsample)
library(car)
#import datasetu Carseats z knižnice ISLR
data(Carseats)
View(Carseats)
#Načítanie datasetu do premennej na následné spracovanie, úpravu a analýzu
seats <- Carseats
summary(seats)
colSums(is.na(seats))
hist(seats$Sales)
ggplot(seats, aes(x = Price, y = Sales)) +
geom_line(color = "purple") +
labs(title = "Ako cena sedačiek ovplyvňuje ich predaje",
x = "Cena", y = "Predaje")
ggplot(seats, aes(x = Advertising, y = Sales)) +
geom_point(color = "purple") +
labs(title = "Ako reklama ovplyvňuje predaje autosedačiek",
x = "Reklama", y = "Predaje")
boxplot(Sales ~ ShelveLoc, data = seats)
num <- seats %>% select_if(is.numeric)
cor(num)
#Faktorizácia premenných
seats$ShelveLoc <- factor(seats$ShelveLoc)
seats$Urban <- factor(seats$Urban)
seats$US <- factor(seats$US)
lm_model <- lm(Sales ~ Price + Advertising + Income + Age + ShelveLoc,
data = seats)
summary(lm_model)
#Výsledok vif testu si uložíme do premennej, ktorú následne zobrazíme pomocou príkazu print()
vif <- vif(lm_model)
print(vif)
#Nastavíme seed, aby sme zaistili náhodnosť pri výbere dát do trénovacej a testovacej množiny
set.seed(123)
#Následne rozdelíme dáta do trénovacej a testovacej množiny
split <- initial_split(seats, prop = 0.7)
train <- training(split)
test <- testing(split)
#Vytvoríme model z trénovacej množiny dát
train_model <- lm(Sales ~ Price + Advertising + Income + ShelveLoc + Age, data = train)
summary(train_model)
#Použijeme funkciu predict, aby sme predpovedali predaje na základe nášho trénovacieho modelu
pred <- predict(train_model, newdata = test)
#Keďže predpovedáme číselné hodnoty, vytvoríme si ďalšiu premennú, kde zostrojíme tabuľku, do ktorej pridáme hodnoty, ktoré predikoval náš model (predicted) a rozdiel medzi skutočnými hodnotami predaja (difference)
difference_table <- test
difference_table$predicted <- pred
difference_table$difference <- difference_table$Sales - difference_table$predicted
difference_table$index <- as.numeric(rownames(difference_table))
#Nakoniec vyberieme tri stĺpce a zobrazíme hodnoty
final_predict_table <- difference_table %>%
select(Sales, predicted, difference)
head(final_predict_table)
#Vyberieme riadky s indexami 1, 6 a 12 a odstránime štatisticky nevýznamné stĺpce
difference_table[difference_table$index %in% c(1,6, 12), !names(difference_table) %in% c("Population", "Education", "CompPrice", "Urban", "US")]
rmse <- sqrt(mean((pred - test$Sales)^2))
rmse
plot(final_predict_table$Sales, final_predict_table$predicted,
xlab = "Skutočné hodnoty (Sales)",
ylab = "Predikované hodnoty",
main = "Skutočné vs Predikované predaje",
pch = 19)
ggplot(seats, aes(x = Price, y = Sales)) +
geom_point(color = "purple") +
labs(title = "Ako cena sedačiek ovplyvňuje ich predaje",
x = "Cena", y = "Predaje")
